(function(){var h=function(a){return"[object Array]"===Object.prototype.toString.apply(a)},d={logInfo:!1,info:function(a){this.logInfo&&console.log(a)}},e={async:!("undefined"!==typeof module&&module.exports),mainContext:null,tree:{},traversing:!1,fnComplete:null,fnCompleteContext:{},completed:!1,dependencies_solved:{},anonymousModulesCount:0,onComplete:function(a,b){this.fnComplete=a;this.fnCompleteContext=b},setCompleted:function(){this.fnComplete&&(this.fnComplete.apply(this.fnCompleteContext),
this.fnComplete=null);this.completed=!0},define:function(){this.completed=!1;var a=Array.prototype.slice.call(arguments),b=a[0],c=a[1]||[],a=a[2];"string"!==typeof b&&("object"===typeof b&&!h(b)||"function"===typeof b)?(a=b,b="anonymous"+this.anonymousModulesCount++):"string"!==typeof b&&h(b)?(a=c,c=b,b="anonymous"+this.anonymousModulesCount++):"string"===typeof b&&!h(c)&&(a=c,c=[]);originalDependencies=c.slice(0);c=this.rejectSolvedDependencies(c);this.tree[b]={key:b,namespace:null,originalDependencies:originalDependencies,
dependencies:c,body:a,loaded:!1};0===c.length?this.loadModule(this.tree[b]):this.defer(this.startWorker)},require:function(a){if(h(a))this.define.apply(this,arguments);else return this.keyToNamespace(a)},defer:function(a,b){this.async?(context=this,setTimeout(function(){a.apply(context)},b||0)):a.apply(this)},startWorker:function(){!this.traversing&&!this.completed&&(this.traversing=!0,this.defer(function(){this.traverse();this.traversing=!1;this.defer(this.startWorker,this.nextTurn())}))},nextTurn:function(){var a=
0,b=0,c=1;return function(){b=a+c;a=c;c=b;return 100*b}}(),traverse:function(){var a=0;for(key in this.tree){var b=this.tree[key];b.loaded||(d.info("Traverse: "+key),b.dependencies&&0<b.dependencies.length?this.satisfy(b)?this.loadModule(b):a++:this.loadModule(b))}0===a&&this.setCompleted()},getDepenciesNamespaces:function(a){var b=[],c;for(c in a)b.push(this.keyToNamespace(a[c]));return b},loadModule:function(a){if("function"===typeof a.body){a.namespace=a.namespace||{};var b=this.getDepenciesNamespaces(a.originalDependencies),
b=a.body.apply({},b);void 0!==b&&(a.namespace=b)}else a.namespace=a.body;this.writeKeyNamespace(a.key,a.namespace)&&(a.loaded=!0,d.info('Loaded "'+a.key+'" as: '+typeof a.body),this.removeDependency(a.key))},rejectSolvedDependencies:function(a){var b=[];for(dep in a)this.dependencies_solved[a[dep]]||b.push(a[dep]);return b},removeDependency:function(a){for(var b in this.tree){var c=this.tree[b],d=[],f;for(f in c.dependencies)c.dependencies[f]!=a&&d.push(c.dependencies[f]);c.dependencies=d}this.dependencies_solved[a]=
!0},keyToNamespace:function(a){var b;if((b=this.keyToNamespaceByContext(a,this.rootContext))||(b=this.keyToNamespaceByContext(a,this.mainContext)))return b},keyToNamespaceByContext:function(a,b){if("require"===a)return this.require;var c;a.match(".")?c=a.split("."):a.match("/")&&(c=a.split("/"));try{c.forEach(function(a){b=b[a]})}catch(d){}return b},writeKeyNamespace:function(a,b){var c=a.split("."),d=c.slice(0,-1),c=c.slice(-1).toString(),f=this.mainContext,e;for(e in d){var g=d[e];if(!f[g])return!1;
f=f[g]}f[c]=b;return!0},satisfy:function(a){var b=!1;d.info('Satisfying: "'+a.key+'" dependencies: '+(0==a.dependencies.length?"none":a.dependencies));a.dependencies.forEach(function(a){void 0!==this.tree[a]?0==this.tree[a].dependencies.length&&!this.tree[a].loaded?this.loadModule(this.tree[a]):b=!0:void 0!==this.keyToNamespace(a)?(d.info("Found: "+a),this.removeDependency(a)):this.async?(d.info("Missing: "+a),b=!0):(d.info("I'll find you: "+a),this.traverse())},this);return!b},rootContext:this,mainContext:{}},
g={define:function(){return e.define.apply(e,arguments)},require:function(){return e.require.apply(e,arguments)},onComplete:function(){return e.onComplete.apply(e,arguments)},logger:d};g.define.amd={};define=g.define;e.async?(this.fletcher=g,this.require=g.require):module.exports=g}).call(this);
